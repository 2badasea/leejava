<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.bada.leejava.quizcard.QuizcardMapper">

	<insert id="quizcardSetCreate" parameterType="co.bada.leejava.quizcard.QuizcardVO">
		INSERT INTO QUIZCARD VALUES(
			SET_NO_SEQ.NEXTVAL,   <!-- 시퀀스 적용. -->
			#{m_email},
			#{quizcard_set_name},
			TO_CHAR( SYSDATE, 'YYYY-MM-DD  HH:MI:SS'),
			TO_CHAR( SYSDATE, 'YYYY-MM-DD  HH:MI:SS'),
			0,
			#{quizcard_set_status},
			#{quizcard_set_intro},
			0,
			#{quizcard_type}
		)
	</insert>
	
	<select id="quizcardSetNoGet" resultType="int">
		SELECT LAST_NUMBER
			FROM USER_SEQUENCES
		WHERE SEQUENCE_NAME = 'SET_NO_SEQ'
	</select>
	
	<insert id="quizcardCategory" parameterType="co.bada.leejava.quizcard.QuizcardVO">
		insert into quizcard_category values(
			1,
			#{quizcard_set_no},
			#{quizcard_category_name}
		)
	</insert>
	
	<select id="quizcardSelect" resultType="co.bada.leejava.quizcard.QuizcardVO">
		SELECT Q.QUIZCARD_SET_NO, Q.QUIZCARD_SET_NAME, Q.QUIZCARD_SET_CDATE, 
				Q.QUIZCARD_SET_UDATE, Q.QUIZCARD_SET_STATUS, Q.QUIZCARD_SET_INTRO,
				 Q.QUIZCARD_TYPE ,C.QUIZCARD_CATEGORY 
		FROM QUIZCARD Q INNER JOIN QUIZCARD_CATEGORY C 
		ON Q.QUIZCARD_SET_NO = C.QUIZCARD_SET_NO
		WHERE Q.QUIZCARD_SET_NO = #{quizcard_set_no}
	</select>
	
	<!--  -->
	<insert id="firstQuestionInsert" parameterType="co.bada.leejava.quizcard.QuizcardVO">
		INSERT INTO QUIZCARD_QUESTION VALUES(
			TO_NUMBER( #{quizcard_set_no}||'0'||1 ),
			1,
			#{quizcard_set_no},
			'문제를 입력하세요',
			'힌트를 입력하세요',
			'답안을 입력하세요'
		)
	</insert>

</mapper>